---
---
---
permalink: /products.html
---
<!doctype html>
<html lang="en-CA">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Premium Supply — Catalogue</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <!-- Always-on promo band -->
  <div class="adband">
    <div class="container adband__inner">
      <div class="adband__tag">PROMO</div>
      <div class="adband__marquee" aria-label="Promotions">
        <div class="adband__track">
          <span>Weekly deals • Limited drops • Canada-wide shipping</span><span class="sep">•</span>
          <span>Minimum order $75 CAD • Instructions shown after placing order</span><span class="sep">•</span>
          <span>Earn points & levels • Check Account page</span><span class="sep">•</span>

          <span>Weekly deals • Limited drops • Canada-wide shipping</span><span class="sep">•</span>
          <span>Minimum order $75 CAD • Instructions shown after placing order</span><span class="sep">•</span>
          <span>Earn points & levels • Check Account page</span><span class="sep">•</span>
        </div>
      </div>
      <a class="adband__cta" href="account.html">Rewards</a>
    </div>
  </div>

  <!-- Header -->
  <header class="header">
    <div class="container header__inner">
      <a class="brand" href="index.html">
        <img class="brand__logo" src="assets/brand/logo-round.png" alt="Premium Supply logo">
        <span class="brand__text">
          <span class="brand__name">Premium Supply</span>
          <span class="brand__tag">Catalogue • CAD</span>
        </span>
      </a>

      <nav class="nav" aria-label="Primary navigation">
        <a href="index.html">Home</a>
        <a href="products.html" aria-current="page">Catalogue</a>
        <a href="account.html">Account</a>
      </nav>

      <div class="header__right">
        <button class="btn btn--solid" id="openCart" type="button">
          Cart (<span id="cartCount">0</span>)
        </button>
      </div>
    </div>

    <!-- Category chips -->
    <div class="container catbar" aria-label="Catalogue categories">
      <a class="chip" href="#cat-flowers">Flowers</a>
      <a class="chip" href="#cat-oil">Oil</a>
      <a class="chip" href="#cat-vapes">Vapes</a>
      <a class="chip" href="#cat-extracts">Extracts</a>
      <a class="chip" href="#cat-mushroom">Mushroom</a>
      <a class="chip" href="#cat-accessories">Accessories</a>
      <a class="chip" href="#cat-male-enhancers">Male Enhancers</a>
    </div>
  </header>

  <main class="section">
    <div class="container">
      <!-- Universal-style billboard -->
      <div class="billboard">
        <img class="billboard__img" src="assets/brand/logo-universal.png" alt="Premium Supply">
        <div class="billboard__overlay" aria-hidden="true"></div>
        <div class="billboard__content">
          <div>
            <p class="billboard__headline">Browse → Cart → Summary → Checkout</p>
            <p class="billboard__sub">Minimum order is <strong>$75 CAD</strong>. Payment instructions appear only after you place the order.</p>
          </div>
          <a class="btn btn--outline" href="account.html">Points</a>
        </div>
      </div>

      {% assign categories = "Flowers|Oil|Vapes|Extracts|Mushroom|Accessories|Male Enhancers" | split: "|" %}

      {% for cat in categories %}
        {% assign cat_id = cat | downcase | replace: " ", "-" %}
        {% assign items = site.products | where: "active", true | where: "category", cat %}

        <section class="catsec" id="cat-{{ cat_id }}">
          <div class="catsec__head">
            <h2 class="catsec__title">{{ cat }}</h2>
            <p class="catsec__note">Updated regularly • CAD pricing</p>
          </div>

          {% if items and items.size > 0 %}
            <div class="grid">
              {% for p in items %}
                <article class="card product"
                  data-url="{{ p.url | relative_url }}"
                  data-sku="{{ p.sku | escape }}"
                  data-name="{{ p.name | escape }}"
                  data-price="{{ p.price | default: 0 }}"
                  data-category="{{ p.category | escape }}"
                  data-has-variants="{% if p.variants and p.variants.size > 0 %}1{% else %}0{% endif %}"
                >
                  <div class="card__img">
                    {% if p.image %}
                      <img src="{{ p.image | escape }}" alt="{{ p.name | escape }}">
                    {% else %}
                      <div class="ph" aria-hidden="true"></div>
                    {% endif %}
                  </div>

                  <div class="card__body">
                    <div class="meta">
                      <span class="badge">{% if p.badge %}{{ p.badge }}{% else %}Standard{% endif %}</span>
                      <span class="sku">SKU: {{ p.sku }}</span>
                    </div>

                    <h3 class="card__title">{{ p.name }}</h3>
                    <p class="card__desc">{% if p.description %}{{ p.description }}{% else %}Premium-grade product with consistent packaging standards.{% endif %}</p>

                    <div class="foot">
                      <div class="price">
                        {% if p.variants and p.variants.size > 0 %}
                          <strong>From ${{ p.variants[0].price }} CAD</strong>
                        {% else %}
                          <strong>${{ p.price }} CAD</strong>
                        {% endif %}
                        {% if p.price_note %}<span class="muted small">{{ p.price_note }}</span>{% endif %}
                      </div>

                      {% if p.variants and p.variants.size > 0 %}
                        <!-- Flowers / variant products: choose size on product page -->
                        <a class="btn btn--outline" href="{{ p.url | relative_url }}">Choose size</a>
                      {% else %}
                        <!-- Non-variant products: quick add -->
                        <button class="btn btn--outline addBtn" type="button">Add</button>
                      {% endif %}
                    </div>
                  </div>
                </article>
              {% endfor %}
            </div>
          {% else %}
            <div class="adcard">
              <h3>No products yet in {{ cat }}</h3>
              <p>Your employee can add products using the admin panel.</p>
              <div class="adcard__actions">
                <a class="btn btn--outline" href="admin/">Open admin</a>
              </div>
            </div>
          {% endif %}
        </section>
      {% endfor %}

      <footer class="footer">
        <div class="container footer__inner">
          <span>© Premium Supply • Catalogue</span>
          <span class="muted small">Cart → Summary → Checkout (fixed)</span>
        </div>
      </footer>
    </div>
  </main>

  <!-- Backdrop (shared) -->
  <div class="backdrop" id="backdrop" hidden></div>

  <!-- Cart drawer -->
  <aside class="drawer" id="drawer" aria-hidden="true">
    <div class="drawer__head">
      <strong>Your Cart</strong>
      <button class="btn btn--outline" id="closeCart" type="button">Close</button>
    </div>

    <div class="drawer__body" id="cartItems"></div>

    <div class="drawer__foot">
      <div class="row">
        <span>Total</span>
        <strong id="cartTotal">$0.00 CAD</strong>
      </div>

      <div class="minrule" id="minRule">Minimum order is $75 CAD.</div>

      <button class="btn btn--solid btn--full" id="reviewBtn" type="button">
        Review cart summary
      </button>

      <p class="muted small" style="margin:10px 0 0">
        Payment instructions are shown only after you place the order.
      </p>
    </div>
  </aside>

  <!-- Checkout modal (multi-step) -->
  <div class="modal" id="modal" hidden>
    <div class="panel" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="panel__head">
        <strong id="modalTitle">Checkout</strong>
        <button class="btn btn--outline" id="closeModal" type="button">Close</button>
      </div>

      <div class="panel__body">

        <!-- STEP 0: Cart Summary -->
        <section id="step0">
          <p class="muted small">Confirm your order summary before checkout.</p>

          <div id="summaryLines"></div>

          <div class="divider"></div>

          <div class="row">
            <span>Order total</span>
            <strong id="summaryTotal">$0.00 CAD</strong>
          </div>

          <div class="minrule" id="summaryMinRule">Minimum order is $75 CAD.</div>

          <button class="btn btn--solid btn--full" id="toCheckoutBtn" type="button">
            Continue to checkout
          </button>

          <button class="btn btn--ghost btn--full" id="backToCartBtn" type="button" style="margin-top:10px">
            Back to cart
          </button>
        </section>

        <!-- STEP 1: Customer Info + Place Order -->
        <section id="step1" hidden>
          <p class="muted small">Enter your information, then place the order to generate a confirmation number.</p>

          <div class="formgrid">
            <label class="field">
              <span>Full name *</span>
              <input id="custName" type="text" placeholder="Your name">
            </label>
            <label class="field">
              <span>Phone *</span>
              <input id="custPhone" type="tel" placeholder="( ___ ) ___-____">
            </label>
            <label class="field">
              <span>City / Province *</span>
              <input id="custCity" type="text" placeholder="Toronto, ON">
            </label>
            <label class="field">
              <span>Address (optional)</span>
              <input id="custAddr" type="text" placeholder="Street, unit, postal code">
            </label>
          </div>

          <div class="divider"></div>

          <div class="row">
            <span>Order total</span>
            <strong id="checkoutTotal">$0.00 CAD</strong>
          </div>

          <div id="formError" class="danger" hidden>Please fill in: Full name, Phone, City / Province.</div>

          <button class="btn btn--solid btn--full" id="placeOrderBtn" type="button" style="margin-top:10px">
            Place Order
          </button>

          <p class="muted small" style="margin:10px 0 0">
            Payment instructions appear after placing the order.
          </p>
        </section>

        <!-- STEP 2: Payment Instructions -->
        <section id="step2" hidden>
          <p class="muted small">Order confirmation number</p>
          <div class="copyrow">
            <strong id="orderId" class="mono"></strong>
            <button class="btn btn--outline" id="copyOrderId" type="button">Copy</button>
          </div>

          <div class="divider"></div>

          <h3 class="h3">Interac e‑Transfer instructions</h3>
          <ol class="olist">
            <li>Send an Interac e‑Transfer to: <strong id="payEmail" class="mono"></strong></li>
            <li>Include your order number in the transfer message/notes.</li>
            <li>Click the button below to email your order request.</li>
          </ol>

          <div class="danger">
            Account will be closed after 24h without payment.
            <div class="muted small" id="expiryLine"></div>
          </div>

          <div class="divider"></div>

          <a class="btn btn--solid btn--full" id="emailOrderBtn" href="#">
            Email order request
          </a>

          <details class="summary">
            <summary>View / copy order summary</summary>
            <pre id="orderSummary"></pre>
          </details>
        </section>

      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast" hidden>
    <span>Added to cart</span>
    <button class="btn btn--outline" id="toastViewCart" type="button">View cart</button>
  </div>

  <script>
    // ======================
    // CONFIG
    // ======================
    const ORDER_EMAIL = "orders@premiumsupply.ca";
    const PAY_USER = "payments";
    const PAY_DOMAIN = "premiumsupply.ca";

    const MIN_ORDER_CAD = 75;
    const POINTS_PER_DOLLAR = 1;

    // IMPORTANT: variant-aware cart
    const cartKey = "ps_cart_v3";
    const loyaltyKey = "ps_loyalty_v2";
    // ======================

    const $ = (s) => document.querySelector(s);
    const fmt = (n) => new Intl.NumberFormat(undefined, { style:"currency", currency:"CAD" }).format(Number(n||0));

    const backdrop = $("#backdrop");
    const drawer = $("#drawer");
    const modal = $("#modal");

    const cartCountEl = $("#cartCount");
    const cartItemsEl = $("#cartItems");
    const cartTotalEl = $("#cartTotal");
    const minRuleEl = $("#minRule");

    const summaryLinesEl = $("#summaryLines");
    const summaryTotalEl = $("#summaryTotal");
    const summaryMinRuleEl = $("#summaryMinRule");

    const checkoutTotalEl = $("#checkoutTotal");
    const formErrorEl = $("#formError");

    const toast = $("#toast");
    const toastViewCart = $("#toastViewCart");

    // ---------- Cart model ----------
    // cart = { "SKU" or "SKU::Variant": { sku, name, variant, unitPrice, qty } }

    function lineKey(sku, variant){
      return variant ? (sku + "::" + variant) : sku;
    }

    function getProductFromDOM(sku){
      const el = document.querySelector('.product[data-sku="' + CSS.escape(sku) + '"]');
      if(!el) return null;
      return {
        sku,
        name: el.dataset.name || sku,
        unitPrice: Number(el.dataset.price || 0)
      };
    }

    function readCart(){
      let raw = {};
      try{ raw = JSON.parse(localStorage.getItem(cartKey) || "{}"); }catch(e){ raw = {}; }

      // MIGRATION: old format was { sku: qtyNumber }
      const needsMigration = raw && typeof raw === "object" && Object.values(raw).some(v => typeof v === "number");
      if(needsMigration){
        const migrated = {};
        for(const sku in raw){
          const qty = Number(raw[sku] || 0);
          if(qty <= 0) continue;
          const p = getProductFromDOM(sku);
          migrated[sku] = {
            sku,
            name: p ? p.name : sku,
            variant: "",
            unitPrice: p ? p.unitPrice : 0,
            qty
          };
        }
        raw = migrated;
        localStorage.setItem(cartKey, JSON.stringify(raw));
      }
      return (raw && typeof raw === "object") ? raw : {};
    }

    function saveCart(cart){
      localStorage.setItem(cartKey, JSON.stringify(cart));
    }

    function countItems(cart){
      return Object.values(cart).reduce((sum, item) => sum + (Number(item.qty)||0), 0);
    }

    function cartTotal(cart){
      return Object.values(cart).reduce((sum, item) => sum + (Number(item.unitPrice||0) * (Number(item.qty)||0)), 0);
    }

    function openDrawer(){
      drawer.classList.add("is-open");
      drawer.setAttribute("aria-hidden","false");
      backdrop.hidden = false;
    }
    function closeDrawer(){
      drawer.classList.remove("is-open");
      drawer.setAttribute("aria-hidden","true");
      backdrop.hidden = true;
    }

    function openModal(){ modal.hidden = false; }
    function closeModal(){ modal.hidden = true; }

    function showToast(){
      toast.hidden = false;
      clearTimeout(showToast._t);
      showToast._t = setTimeout(()=> toast.hidden = true, 2200);
    }

    let cart = readCart();

    function renderCart(){
      cartCountEl.textContent = countItems(cart);

      const total = cartTotal(cart);
      cartTotalEl.textContent = fmt(total) + " CAD";

      if(total < MIN_ORDER_CAD){
        const diff = MIN_ORDER_CAD - total;
        minRuleEl.innerHTML = "<strong>Minimum order:</strong> $" + MIN_ORDER_CAD + " CAD. Add " + fmt(diff) + " more.";
      }else{
        minRuleEl.textContent = "Minimum order met.";
      }

      const keys = Object.keys(cart);
      if(!keys.length){
        cartItemsEl.innerHTML = '<p class="muted">Your cart is empty.</p>';
        return;
      }

      cartItemsEl.innerHTML = keys.map((k)=>{
        const it = cart[k];
        const v = it.variant ? ` • Size: ${it.variant}` : "";
        return `
          <div class="line">
            <div>
              <strong>${it.name}</strong>
              <div class="muted small">SKU: ${it.sku}${v} • ${fmt(it.unitPrice)} CAD</div>
            </div>
            <div class="qty">
              <button class="qbtn" data-dec="${k}" type="button">−</button>
              <strong>${it.qty}</strong>
              <button class="qbtn" data-inc="${k}" type="button">+</button>
            </div>
          </div>
        `;
      }).join("");

      cartItemsEl.querySelectorAll("[data-inc]").forEach((b)=>{
        b.addEventListener("click", ()=>{
          const key = b.getAttribute("data-inc");
          cart[key].qty += 1;
          saveCart(cart);
          renderCart();
        });
      });

      cartItemsEl.querySelectorAll("[data-dec]").forEach((b)=>{
        b.addEventListener("click", ()=>{
          const key = b.getAttribute("data-dec");
          cart[key].qty -= 1;
          if(cart[key].qty <= 0) delete cart[key];
          saveCart(cart);
          renderCart();
        });
      });
    }

    function renderSummary(){
      const keys = Object.keys(cart);
      const total = cartTotal(cart);

      summaryTotalEl.textContent = fmt(total) + " CAD";
      checkoutTotalEl.textContent = fmt(total) + " CAD";

      if(!keys.length){
        summaryLinesEl.innerHTML = '<p class="muted">No items in your cart.</p>';
        $("#toCheckoutBtn").disabled = true;
        summaryMinRuleEl.textContent = "Add items to continue.";
        return;
      }

      summaryLinesEl.innerHTML = keys.map((k)=>{
        const it = cart[k];
        const v = it.variant ? ` • Size: ${it.variant}` : "";
        return `
          <div class="line">
            <div>
              <strong>${it.name}</strong>
              <div class="muted small">SKU: ${it.sku}${v} • Qty: ${it.qty}</div>
            </div>
            <div class="mono">${fmt(it.unitPrice * it.qty)}</div>
          </div>
        `;
      }).join("");

      if(total < MIN_ORDER_CAD){
        const diff = MIN_ORDER_CAD - total;
        summaryMinRuleEl.innerHTML = "<strong>Minimum order:</strong> $" + MIN_ORDER_CAD + " CAD. Add " + fmt(diff) + " more.";
        $("#toCheckoutBtn").disabled = true;
      }else{
        summaryMinRuleEl.textContent = "Minimum order met.";
        $("#toCheckoutBtn").disabled = false;
      }
    }

    function makeOrderId(){
      const d = new Date();
      const pad = (x) => String(x).padStart(2,"0");
      const r = Math.floor(Math.random()*9000)+1000;
      return `PS-${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}-${pad(d.getHours())}${pad(d.getMinutes())}${pad(d.getSeconds())}-${r}`;
    }

    function addLoyaltyPoints(total){
      const earned = Math.floor(total * POINTS_PER_DOLLAR);
      const data = JSON.parse(localStorage.getItem(loyaltyKey) || "{}");
      data.points = Number(data.points || 0) + earned;
      data.spend = Number(data.spend || 0) + total;
      data.orders = Number(data.orders || 0) + 1;
      data.updatedAt = Date.now();
      localStorage.setItem(loyaltyKey, JSON.stringify(data));
      return earned;
    }

    function buildOrderEmail(orderId, expiresAt, payEmail){
      const lines = [];
      lines.push("Premium Supply — Order Request");
      lines.push("Order #: " + orderId);
      lines.push("Expires: " + new Date(expiresAt).toLocaleString());
      lines.push("");
      lines.push("Customer:");
      lines.push("- Name: " + ($("#custName").value || ""));
      lines.push("- Phone: " + ($("#custPhone").value || ""));
      lines.push("- City/Province: " + ($("#custCity").value || ""));
      lines.push("- Address: " + ($("#custAddr").value || ""));
      lines.push("");
      lines.push("Items:");

      let total = 0;
      for(const k in cart){
        const it = cart[k];
        total += (it.unitPrice * it.qty);
        const v = it.variant ? (" [" + it.variant + "]") : "";
        lines.push("- " + it.name + " (SKU: " + it.sku + ")" + v + " x" + it.qty + " — " + fmt(it.unitPrice) + " CAD each");
      }

      lines.push("");
      lines.push("Total: " + fmt(total) + " CAD");
      lines.push("");
      lines.push("Payment: Interac e-Transfer");
      lines.push("Send to: " + payEmail);
      lines.push("Include Order # in transfer notes: " + orderId);
      lines.push("");
      lines.push("Account will be closed after 24h without payment.");

      return { body: lines.join("\\n"), total };
    }

    // ---------- Events ----------

    // Quick add (non-variant items only)
    document.querySelectorAll(".addBtn").forEach((btn)=>{
      btn.addEventListener("click", ()=>{
        const card = btn.closest(".product");
        const sku = card.dataset.sku;
        const name = card.dataset.name;
        const unitPrice = Number(card.dataset.price || 0);

        const key = lineKey(sku, "");
        if(cart[key]) cart[key].qty += 1;
        else cart[key] = { sku, name, variant:"", unitPrice, qty: 1 };

        saveCart(cart);
        renderCart();
        showToast();
      });
    });

    // Card click -> go to product page (unless clicking a button/link)
    document.querySelectorAll(".product").forEach(card => {
      card.style.cursor = "pointer";
      card.addEventListener("click", (e) => {
        if (e.target.closest("button, a, input, select, textarea, label")) return;
        const url = card.getAttribute("data-url");
        if (url) window.location.href = url;
      });
    });

    // Toast opens cart
    toastViewCart.addEventListener("click", ()=>{
      toast.hidden = true;
      renderCart();
      openDrawer();
    });

    // Cart open/close
    $("#openCart").addEventListener("click", ()=>{
      renderCart();
      openDrawer();
    });
    $("#closeCart").addEventListener("click", closeDrawer);

    backdrop.addEventListener("click", ()=>{
      closeDrawer();
      closeModal();
    });

    // Review cart summary (opens step0)
    $("#reviewBtn").addEventListener("click", ()=>{
      renderSummary();
      $("#step0").hidden = false;
      $("#step1").hidden = true;
      $("#step2").hidden = true;
      openModal();
    });

    $("#closeModal").addEventListener("click", closeModal);

    $("#backToCartBtn").addEventListener("click", ()=>{
      closeModal();
      renderCart();
      openDrawer();
    });

    $("#toCheckoutBtn").addEventListener("click", ()=>{
      renderSummary();
      if($("#toCheckoutBtn").disabled) return;

      formErrorEl.hidden = true;
      $("#step0").hidden = true;
      $("#step1").hidden = false;
      $("#step2").hidden = true;
      checkoutTotalEl.textContent = fmt(cartTotal(cart)) + " CAD";
    });

    $("#placeOrderBtn").addEventListener("click", ()=>{
      const total = cartTotal(cart);
      if(total < MIN_ORDER_CAD){
        formErrorEl.hidden = false;
        formErrorEl.textContent = "Minimum order is $75 CAD.";
        return;
      }

      const name = $("#custName").value.trim();
      const phone = $("#custPhone").value.trim();
      const city = $("#custCity").value.trim();
      if(!name || !phone || !city){
        formErrorEl.hidden = false;
        return;
      }
      formErrorEl.hidden = true;

      const orderId = makeOrderId();
      const expiresAt = Date.now() + 24*60*60*1000;
      const payEmail = PAY_USER + "@" + PAY_DOMAIN;

      const built = buildOrderEmail(orderId, expiresAt, payEmail);
      addLoyaltyPoints(built.total);

      $("#orderId").textContent = orderId;
      $("#payEmail").textContent = payEmail;
      $("#expiryLine").textContent = "Pay before: " + new Date(expiresAt).toLocaleString();
      $("#orderSummary").textContent = built.body;

      const subject = "Order Confirmation " + orderId;
      const mailto = "mailto:" + encodeURIComponent(ORDER_EMAIL)
        + "?subject=" + encodeURIComponent(subject)
        + "&body=" + encodeURIComponent(built.body);

      $("#emailOrderBtn").setAttribute("href", mailto);

      // Clear cart AFTER placing order
      cart = {};
      saveCart(cart);
      renderCart();

      $("#step0").hidden = true;
      $("#step1").hidden = true;
      $("#step2").hidden = false;
    });

    $("#copyOrderId").addEventListener("click", async ()=>{
      try{
        await navigator.clipboard.writeText($("#orderId").textContent);
        $("#copyOrderId").textContent = "Copied";
        setTimeout(()=> $("#copyOrderId").textContent = "Copy", 1200);
      }catch(e){
        $("#copyOrderId").textContent = "Copy failed";
        setTimeout(()=> $("#copyOrderId").textContent = "Copy", 1200);
      }
    });

    // Init
    renderCart();
  </script>
</body>
</html>